
{% extends "base.html" %}
{% block title %}Cadastrar Usuário{% endblock %}
{% block content %}
    <div class="max-w-2xl mx-auto p-4 bg-white rounded-lg shadow">
        <h2 class="text-2xl font-bold mb-4 text-gray-800">
            {{ 'Editar Usuário' if usuario else 'Cadastro de Usuário' }}
        </h2>

        {% with messages = get_flashed_messages(with_categories=true) %}
            {% for category, message in messages %}
                <p class="text-red-600 mb-4 text-sm">{{ message }}</p>
            {% endfor %}
        {% endwith %}

        <form method="POST" action="{{ action_url }}" class="space-y-4">
            <div>
                <label for="nome" class="block text-sm font-medium text-gray-700 mb-1">Nome:</label>
                <input
                    type="text"
                    name="nome"
                    id="nome"
                    value="{{ usuario.nome_usuario if usuario else '' }}"
                    required
                    class="w-full border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
                >
            </div>

            <div>
                <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Email:</label>
                <input
                    type="email"
                    name="email"
                    id="email"
                    value="{{ usuario.email_usuario if usuario else '' }}"
                    required
                    class="w-full border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
                >
            </div>

            <div class="mb-4">
                <label for="senha" class="block text-sm font-medium text-gray-700 mb-1">Senha:</label>
                <div class="relative w-full">
                    <input
                        type="password"
                        name="senha"
                        id="senha"
                        required
                        placeholder="Digite sua senha"
                        class="w-full border border-gray-300 rounded px-3 py-2 pr-10 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
                    >
                    <div class="absolute top-1/3 right-0 -translate-y-1/2 flex items-center justify-center">
                        <i
                            class="fas fa-eye text-gray-400 hover:text-gray-600 transition-colors duration-200 cursor-pointer toggle-password"
                            toggle="#senha"
                        ></i>
                    </div>
                </div>
            </div>

            <div class="mb-4">
                <label for="confirmar_senha" class="block text-sm font-medium text-gray-700 mb-1">Confirmar Senha:</label>
                <div class="relative w-full">
                    <input
                        type="password"
                        name="confirmar_senha"
                        id="confirmar_senha"
                        required
                        placeholder="Confirme sua senha"
                        class="w-full border border-gray-300 rounded px-3 py-2 pr-10 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
                    >
                    <div class="absolute top-1/3 right-0 -translate-y-1/2 flex items-center justify-center">
                        <i
                            class="fas fa-eye text-gray-400 hover:text-gray-600 transition-colors duration-200 cursor-pointer toggle-password"
                            toggle="#confirmar_senha"
                        ></i>
                    </div>
                </div>
            </div>

            <div>
                <label for="nivel" class="block text-sm font-medium text-gray-700 mb-1">Nível:</label>
                {% set is_user_selected = usuario and usuario.nivel_usuario == 'usuario' %}
                <select
                    name="nivel"
                    id="nivel"
                    class="w-full border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
                >
                    <option value="administrador">Administrador</option>
                    <option value="usuario" {% if is_user_selected %}selected{% endif %}>Usuário</option>
                </select>
            </div>

            <div class="pt-2">
                <button
                    type="submit"
                    class="w-full bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded transition duration-300"
                >
                    {{ 'Salvar Alterações' if usuario else 'Registrar' }}
                </button>
            </div>
        </form>
    </div>

{% endblock %}

{% block scripts %}
    <script src="{{ url_for('static', filename='js/cadastroUsuarios.js') }}"></script>
{% endblock %}