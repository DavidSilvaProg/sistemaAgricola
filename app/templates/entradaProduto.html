{% extends "base.html" %}
{% block title %}Entrada Produto{% endblock %}
{% block content %}
<div class="max-w-3xl mx-auto p-4 bg-white rounded-lg shadow">
	<h2 class="text-2xl font-bold mb-4 text-gray-800">Entrada</h2>
	{% with messages = get_flashed_messages() %}
		{% if messages %}
			<div class="mb-4">
				{% for message in messages %}
					<div class="bg-green-100 text-green-800 text-sm px-4 py-2 rounded shadow mb-2">
						{{ message }}
					</div>
				{% endfor %}
			</div>
		{% endif %}
	{% endwith %}
	<form id="requestForm" action="gravarEntradaProduto" method="post" class="space-y-4">
		<!-- Seleção de produto cadastrado -->
		<div>
			<h2 class="text-lg font-semibold text-gray-700 border-b pb-1 mb-2">Produto</h2>
			<label for="produto-input" class="block text-sm font-medium text-gray-700 mb-1">Selecionar Produto Cadastrado:</label>
			<div class="relative">
				<!-- Input com ícone de lupa -->
				<div class="flex items-center bg-white border border-gray-300 rounded px-3">
					<i class="fas fa-search text-gray-400 mr-2"></i>
					<input
						type="text"
						id="produto-input"
						class="w-full py-2 text-sm text-gray-700 focus:outline-none"
						placeholder="Digite o nome do produto"
						autocomplete="off"
					/>
				</div>

				<!-- Autocomplete fixado com scroll -->
				<div
					id="autocomplete-container"
					class="absolute z-10 mt-1 w-full bg-white border rounded shadow hidden"
					style="max-height: 240px; overflow-y: auto; -webkit-overflow-scrolling: touch; overscroll-behavior: contain;"
				>
					<ul id="autocomplete-list" class="text-sm"></ul>
				</div>
			</div>
		</div>
		<div>
			<label for="quantidade" class="block text-sm font-medium text-gray-700 mb-1">Quantidade:</label>
			<input type="text" id="quantidade" name="quantidade" required
				   class="border border-gray-300 rounded px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 ">
		</div>
		<div>
			<label for="observacao" class="block text-sm font-medium text-gray-700 mb-1">Observação:</label>
			<input type="text" id="observacao" name="observacao"
				   class="w-full border border-gray-300 rounded px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 ">
		</div>

		<!-- Botão de envio -->
		<div class="pt-2">
			<button type="submit"
				class="w-full bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded transition duration-300">
				✔ Enviar
			</button>
		</div>
	</form>
</div>
{% endblock %}

{% block scripts %}
<script>
	window.produtos = [
		{% for produto in produtos %}
			{ nome: "{{ produto.nome_produto }}", id: "{{ produto.id_produto }}", unidade: "{{ produto.unidade_medida_produto }}" },
		{% endfor %}
	];
</script>
<script src="{{ url_for('static', filename='js/entradaProduto.js') }}"></script>
{% endblock %}
